<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <record id='openapi_namespace_model_view_tree' model='ir.ui.view'>
        <field name="name">openapi.namespace.tree</field>
        <field name="model">openapi.namespace</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name" />
            </tree>
        </field>
    </record>

    <record model="ir.ui.view" id="namespace_form_view">
        <field name="name">openapi.namespace.form</field>
        <field name="model">openapi.namespace</field>
        <field name="arch" type="xml">
            <form string="Namespace">
              <sheet>
                <div class="oe_button_box" name="button_box">
                    <button name="toggle_active" type="object" class="oe_stat_button" icon="fa-archive">
                        <field name="active" widget="boolean_button" options='{"terminology": "archive"}'/>
                    </button>
                </div>
                <div class="oe_title">
                    <label for="name" class="oe_edit_only"/>
                    <h1>
                        <field name="name" class="oe_inline"/>
                    </h1>
                    <label for="description" class="oe_edit_only"/>
                    <h3>
                        <field name="description"/>
                    </h3>
                    <field name="id" invisible="1"/>
                    <group>
                        <field name="log_request"/>
                        <field name="log_response"/>
                        <field name="last_log_date" readonly="1"/>
                        <field name="token"/>
                        <field name="spec_url" widget="url" readonly="1"/>
                    </group>
                </div>
                <notebook>
                    <page string="Accessable models">
                        <field name="access_ids"
                               attrs="{'readonly': [('id', '=', False)]}"
                               context="{'default_namespace_id': active_id}"
                        >
                            <tree>
                                <field name="active"/>
                                <field name="model_id"/>
                            </tree>
                        </field>
                    </page>
                    <page string="Logs">
                        <field name="log_ids"
                               attrs="{'readonly': [('id', '=', False)]}"
                               context="{'default_namespace_id': active_id}"
                        >
                            <tree>
                                <field name="create_date"/>
                                <field name="create_uid"/>
                                <!--TODO: maybe we need such a field?-->
                                <!--<field name="request_method"/>-->
                            </tree>
                        </field>
                    </page>
                </notebook>
              </sheet>
            </form>
        </field>
    </record>


    <record model="ir.ui.view" id="access_ir_exports_form_view">
        <field name="name">openapi.access.exports.form</field>
        <field name="model">ir.exports</field>
        <field name="arch" type="xml">
            <tree>
                <field name="export_fields"
                   attrs="{'readonly': [('id', '=', False)]}"
                />
            </tree>
        </field>
    </record>

    <record model="ir.ui.view" id="access_form_view">
        <field name="name">openapi.access.form</field>
        <field name="model">openapi.access</field>
        <field name="arch" type="xml">
            <form string="Access">
              <sheet>
                <div class="oe_button_box" name="button_box">
                    <button name="toggle_active" type="object" class="oe_stat_button" icon="fa-archive">
                        <field name="active" widget="boolean_button" options='{"terminology": "archive"}'/>
                    </button>
                </div>
                <div class="oe_title">
                    <group>
                        <field name="id" invisible="1"/>
                        <field name="namespace_id"
                               attrs="{'invisible': [('namespace_id', '!=', False)]}"
                        />
                        <field name="model" invisible="1"/>
                        <field name="model_id"
                               options="{'no_create': True, 'no_open': True}"
                        />
                        <field name="api_create"/>
                        <field name="api_read"/>
                        <field name="api_update"/>
                        <field name="api_delete"/>
                        <field name="api_public_methods"/>
                        <field name="public_methods"/>
                        <field name="private_methods"/>
                        <!--TODO: namespace_id.name instead str(namespace_id)-->
                        <field name="read_one_id"
                               attrs="{'readonly': [('id', '=', False)]}"
                               context="{'default_resource': model, 'default_name': str(namespace_id) + ' / ' + model + ' / read_one'}"
                        />
                        <field name="read_many_id"
                               attrs="{'readonly': [('id', '=', False)]}"
                               context="{'default_resource': model, 'default_name': str(namespace_id) + ' / ' + model + ' / read_many'}"
                        />
                    </group>
                </div>
                <notebook>
                    <page string="Creation Context Presets">
                        <field name="create_context_ids"
                               attrs="{'readonly': [('id', '=', False)]}"
                        />
                    </page>
                </notebook>
              </sheet>
            </form>
        </field>
    </record>

    <record model="ir.actions.act_window" id="namespace_list_action">
        <field name="name">Namespaces</field>
        <field name="res_model">openapi.namespace</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="help">Create and manage the namespaces.</field>
    </record>

    <menuitem id="main_openapi_menu" name="Open API"/>
    <menuitem id="openapi_menu" name="Open API" parent="main_openapi_menu"/>
    <menuitem id="namespaces_menu" name="Namespaces" parent="openapi_menu" action="namespace_list_action"/>
</odoo>
